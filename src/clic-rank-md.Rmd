---
title: "Web-CLIC Attribute Effects on Design Ranking"
author: "Your Name"
output:
  pdf_document:
    toc: true
    toc_depth: '2'
  html_document:
    toc: true
    toc_depth: 2
    number_sections: true
    theme: readable
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
library(MASS)
library(effects)
library(ggplot2)
library(dplyr)
library(tidyr)
library(gt)
```

# Reshaping input data

```{r}
ranking_long <- cleaned_valid %>%
  dplyr::select(participant_id = id, ranking.1., ranking.2., ranking.3., ranking.4.) %>%
  pivot_longer(cols = starts_with("ranking."),
               names_to = "rank_position",
               values_to = "design") %>%
  mutate(rank = as.numeric(gsub("ranking\\.", "", rank_position))) %>%
  dplyr::select(participant_id, design, rank)
```

# Analysis by Web-CLIC Dimension

## Credibility

```{r}
cred_long <- cleaned_valid %>%
  dplyr::select(participant_id = id, baselineCred, descCred, warnCred, drawingCred) %>%
  pivot_longer(cols = everything()[-1],
               names_to = "design_cred",
               values_to = "cred_score") %>%
  mutate(design = tolower(gsub("Cred", "", design_cred))) %>%
  dplyr::select(participant_id, design, cred_score)

cred_long$design <- gsub("drawing", "draw", cred_long$design)
cred_long$design <- gsub("baseline", "insta", cred_long$design)

combined_cred_rank <- left_join(ranking_long, cred_long, by = c("participant_id", "design"))

# Spearman Correlation
cor.test(combined_cred_rank$rank, combined_cred_rank$cred_score, method = "spearman")

# Ordinal Logistic Regression
combined_cred_rank$rank <- factor(combined_cred_rank$rank, levels = 4:1, ordered = TRUE)
model <- MASS::polr(rank ~ cred_score, data = combined_cred_rank, Hess = TRUE)
summary(model)
```

## Likeability

```{r}
like_long <- cleaned_valid %>%
  dplyr::select(participant_id = id, baselineLike, descLike, warnLike, drawingLike) %>%
  pivot_longer(cols = everything()[-1],
               names_to = "design_like",
               values_to = "like_score") %>%
  mutate(design = tolower(gsub("Like", "", design_like))) %>%
  dplyr::select(participant_id, design, like_score)

like_long$design <- gsub("drawing", "draw", like_long$design)
like_long$design <- gsub("baseline", "insta", like_long$design)

combined_like_rank <- left_join(ranking_long, like_long, by = c("participant_id", "design"))
cor.test(combined_like_rank$rank, combined_like_rank$like_score, method = "spearman")

combined_like_rank$rank <- factor(combined_like_rank$rank, levels = 4:1, ordered = TRUE)
model_like <- MASS::polr(rank ~ like_score, data = combined_like_rank, Hess = TRUE)
summary(model_like)

```

## Informativeness

```{r}
info_long <- cleaned_valid %>%
  dplyr::select(participant_id = id, baselineInfo, descInfo, warnInfo, drawingInfo) %>%
  pivot_longer(cols = everything()[-1],
               names_to = "design_info",
               values_to = "info_score") %>%
  mutate(design = tolower(gsub("Info", "", design_info))) %>%
  dplyr::select(participant_id, design, info_score)

info_long$design <- gsub("drawing", "draw", info_long$design)
info_long$design <- gsub("baseline", "insta", info_long$design)

combined_info_rank <- left_join(ranking_long, info_long, by = c("participant_id", "design"))
cor.test(combined_info_rank$rank, combined_info_rank$info_score, method = "spearman")

combined_info_rank$rank <- factor(combined_info_rank$rank, levels = 4:1, ordered = TRUE)
model_info <- MASS::polr(rank ~ info_score, data = combined_info_rank, Hess = TRUE)
summary(model_info)
```

## Clarity

```{r}
clar_long <- cleaned_valid %>%
  dplyr::select(participant_id = id, baselineClar, descClar, warnClar, drawingClar) %>%
  pivot_longer(cols = everything()[-1],
               names_to = "design_clar",
               values_to = "clar_score") %>%
  mutate(design = tolower(gsub("Clar", "", design_clar))) %>%
  dplyr::select(participant_id, design, clar_score)

clar_long$design <- gsub("drawing", "draw", clar_long$design)
clar_long$design <- gsub("baseline", "insta", clar_long$design)

combined_clar_rank <- left_join(ranking_long, clar_long, by = c("participant_id", "design"))
cor.test(combined_clar_rank$rank, combined_clar_rank$clar_score, method = "spearman")

combined_clar_rank$rank <- factor(combined_clar_rank$rank, levels = 4:1, ordered = TRUE)
model_clar <- MASS::polr(rank ~ clar_score, data = combined_clar_rank, Hess = TRUE)
summary(model_clar)
```

# Combined

## All Attributes

```{r}
combined_clic_long <- ranking_long %>%
  left_join(cred_long, by = c("participant_id", "design")) %>%
  left_join(like_long, by = c("participant_id", "design")) %>%
  left_join(info_long, by = c("participant_id", "design")) %>%
  left_join(clar_long, by = c("participant_id", "design"))

combined_clic_long$rank <- factor(combined_clic_long$rank, levels = 4:1, ordered = TRUE)

model_clic <- MASS::polr(rank ~ cred_score + like_score + info_score + clar_score, data = combined_clic_long, Hess = TRUE)

ctable <- coef(summary(model_clic))
pvals <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
results_df <- data.frame(
  Predictor = rownames(ctable),
  Estimate = round(ctable[, "Value"], 3),
  Std_Error = round(ctable[, "Std. Error"], 3),
  t_value = round(ctable[, "t value"], 3),
  p_value = ifelse(pvals < 0.001, "< .001", format(round(pvals, 3), nsmall = 3)),
  row.names = NULL
)

results_df <- results_df[!results_df$Predictor %in% c("4|3", "3|2", "2|1"), ]

results_df$Predictor <- recode(results_df$Predictor,
                               "cred_score" = "Credibility",
                               "like_score" = "Likeability",
                               "info_score" = "Informativeness",
                               "clar_score" = "Clarity")
```

## Results Table

```{r}
results_df %>%
  gt() %>%
  tab_header(
    title = md("**Web-CLIC Measurement Impact on Ranking**"),
    subtitle = md("*Ordinal regression coefficients controlling for other variables*")
  ) %>%
  cols_label(
    Estimate = "Impact",
    Std_Error = "Std. Error",
    t_value = "t-value",
    p_value = "p-value"
  ) %>%
  cols_align(align = "center", columns = everything()) %>%
  cols_width(
    everything() ~ px(120)
  ) %>%
  sub_missing(columns = everything(), missing_text = "") %>%
  opt_row_striping() %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  ) %>%
  tab_source_note(
    source_note = md("Note: Impact represents the unique contribution of each Web-CLIC dimension while controlling for the others.")
  )
```

**Interpretation** In a combined ordinal regression model using the
Web-CLIC attributes:

-   Informativeness (β = 0.83, p \< .001) and likeability (β = 0.32, p
    \< .001) were significant positive predictors of higher design
    rankings.

-   Clarity was not statistically significant (p = .07).

-   Credibility had a modest but significant negative association (β =
    –0.38, p = .003) when controlling for the other factors.

-   These findings suggest that informativeness and likeability are the
    most influential factors in shaping user preferences.
